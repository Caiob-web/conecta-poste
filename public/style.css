/* =========================================================
   BASE (mantidas as regras originais do seu style.css)
   ========================================================= */
body,
html {
  margin: 0;
  padding: 0;
  height: 100%;
  font-family: -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
}

#map {
  height: 100vh;
  width: 100vw;
}

/* =========================================================
   PALETA & TOKENS
   ========================================================= */
:root{
  --azul:#0055a5;
  --azul-esc:#003f7d;
  --azul-claro:#eaf2fb;
  --borda:#e5e7eb;
  --texto:#0f172a;
  --texto-2:#374151;
  --bg:#ffffff;
  --bg-suave:#f8fafc;
  --sombra:0 10px 28px rgba(0,0,0,.12);
  --radius:12px;
}

/* =========================================================
   PAINEL DE BUSCA
   (organização, campos, ícones e botões)
   ========================================================= */
.painel-busca{
  position: absolute;
  top: 80px;
  right: 20px;
  width: 340px;                       /* confortável */
  background: var(--bg);
  border-left: 5px solid var(--azul);
  border-radius: var(--radius);
  padding: 16px 14px 14px 14px;
  box-shadow: var(--sombra);
  font-family: inherit;
  z-index: 1000;
}

.painel-busca h3{
  margin: 0 0 14px;
  font-weight: 800;
  color: var(--azul);
  font-size: 16px;
  padding-bottom: 8px;
  border-bottom: 1px dashed var(--borda);
}

/* Campos */
.painel-busca .field{ position: relative; margin-bottom: 10px; }
.painel-busca .field input,
.painel-busca .field textarea{
  width: 100%;
  height: 40px;
  padding: 8px 38px 8px 12px;
  border: 1px solid var(--borda);
  border-radius: 10px;
  font-size: 14px;
  color: var(--texto);
  background: #fff;
  box-sizing: border-box;
  transition: border-color .15s, box-shadow .15s;
}
.painel-busca .field textarea{
  height: 56px;
  resize: vertical;
  min-height: 56px;
}

.painel-busca .field input:focus,
.painel-busca .field textarea:focus{
  outline: none;
  border-color: var(--azul);
  box-shadow: 0 0 0 3px rgba(0,85,165,.15);
}

/* Ícones nos campos */
.painel-busca .field .fa{
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  color:#6b7280;
  font-size: 14px;
  pointer-events: none;
}

/* Grade de botões (2 colunas) */
.painel-busca .actions{
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-top: 6px;
}

/* Botão base (secundário) */
.painel-busca .actions button{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  height: 44px;
  padding: 0 12px;
  border: 1px solid var(--borda);
  border-radius: 10px;
  background: var(--bg-suave);
  color: var(--texto);
  font-size: 14px;
  font-weight: 700;
  letter-spacing:.2px;
  cursor: pointer;
  transition: transform .08s ease, box-shadow .12s ease, background .15s ease, color .15s ease, border-color .15s ease;
  box-shadow: 0 1px 2px rgba(0,0,0,.06);
}
.painel-busca .actions button .fa{ margin-right: 8px; opacity:.88; }
.painel-busca .actions button:hover{ background:#eef2ff; }
.painel-busca .actions button:active{ transform: translateY(1px); }

/* Botões “primários” — Buscar, Filtrar, Análise */
.painel-busca .actions button:nth-child(1),
.painel-busca .actions button:nth-child(3),
.painel-busca .actions button:nth-child(4){
  background: var(--azul);
  border-color: var(--azul);
  color:#fff;
}
.painel-busca .actions button:nth-child(1):hover,
.painel-busca .actions button:nth-child(3):hover,
.painel-busca .actions button:nth-child(4):hover{
  background: var(--azul-esc);
  border-color: var(--azul-esc);
}

/* Estado “perigoso/alerta” opcional (ex.: Resetar) */
.painel-busca .actions button:has(.fa-undo):hover{
  background:#fff1f2;
  border-color:#fecdd3;
}

/* =========================================================
   BOTÕES DE TOPO (toggle, localização, logout)
   ========================================================= */
.botao-topo{
  position: absolute;
  right: 20px;
  width: 40px; height: 40px;
  background: #fff;
  border: 1px solid var(--borda);
  border-radius: 50%;
  box-shadow: 0 2px 10px rgba(0,0,0,.10);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
  transition: background .15s ease, transform .08s ease, box-shadow .15s ease;
  z-index: 1001;
}
.botao-topo:hover{ background: var(--azul-claro); }
.botao-topo:active{ transform: translateY(1px); }
#togglePainel { top: 20px; }
#localizacaoUsuario { top: 68px; }
#logoutBtn { top: 116px; }

/* =========================================================
   LEGENDA
   ========================================================= */
.legenda{
  position: absolute;
  bottom: 20px;
  right: 20px;
  background: rgba(255,255,255,.96);
  padding: 12px;
  border-radius: var(--radius);
  font-size: 13px;
  color: var(--texto-2);
  box-shadow: 0 6px 20px rgba(0,0,0,.10);
}
.legenda-item{ display:flex; align-items:center; gap:8px; margin-bottom:6px; }
.legenda-item:last-child{ margin-bottom:0; }
.legenda-item .bolinha{
  width:12px; height:12px; border-radius:50%;
  border:1px solid #94a3b8;
}

/* =========================================================
   HUD / WIDGET CLIMA + HORA (visual alinhado ao painel)
   ========================================================= */
#widget-clima{
  position:absolute;
  left:20px;
  bottom:20px;
  z-index:2000;
}

/* Caso o JS injete #tempo, estas regras harmonizam o look */
#tempo{
  display:flex;
  flex-direction:column;
  gap:10px;
  padding:12px 14px;
  border-radius:14px;
  background:rgba(255,255,255,.94);
  box-shadow: var(--sombra);
  backdrop-filter: saturate(1.15) blur(2px);
  max-width: 320px;
}

#tempo .hora-row{
  display:flex; align-items:center; gap:8px;
  font: 13px/1.2 inherit;
  color: var(--texto);
  font-weight: 800;
}
#tempo .hora-row .dot{
  width:10px;height:10px;border-radius:50%;
  background:linear-gradient(180deg,#1e3a8a,#2563eb);
  box-shadow:0 0 0 2px #e5e7eb inset;
}

#tempo .weather-card{
  display:flex; flex-direction:column; gap:10px;
  padding:12px 14px;
  border-radius:12px;
  background:rgba(255,255,255,.98);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.6), 0 1px 2px rgba(0,0,0,.06);
  min-width:260px;
}
#tempo .weather-row{ display:flex; align-items:center; gap:10px; min-height:40px; }
#tempo .weather-row img{ width:28px; height:28px; object-fit:contain; }
#tempo .tempo-text{ display:flex; flex-direction:column; gap:2px; font:13px/1.35 inherit; color:#1f2937; }
#tempo .tempo-text b{ font-weight: 800; }
#tempo .tempo-text small{ color:#6b7280; }

#tempo .map-row{
  margin-top:6px; padding-top:8px;
  border-top:1px dashed rgba(0,0,0,.10);
  display:flex; align-items:center; justify-content:space-between; gap:10px;
}
#tempo .map-row .lbl{
  font: 12px/1.1 inherit;
  letter-spacing:.2px;
  color:#475569;
  font-weight:800;
}
#tempo .select-wrap{
  position:relative; display:inline-flex; align-items:center; gap:8px;
  padding:8px 36px 8px 12px;
  border:1px solid var(--borda);
  border-radius:999px; background:#fff;
  transition:border-color .15s, box-shadow .15s;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.6), 0 1px 2px rgba(0,0,0,.06);
}
#tempo .select-wrap:focus-within{ border-color:var(--azul); box-shadow:0 0 0 3px rgba(0,85,165,.15); }
#tempo .select-wrap .ico-globe{ width:16px;height:16px;opacity:.75; }
#tempo .select-wrap .ico-caret{
  position:absolute; right:10px; width:14px; height:14px; opacity:.6; pointer-events:none;
}
#tempo select{
  appearance:none; border:0; outline:none; background:transparent; padding:0; margin:0;
  font: 13px/1.2 inherit; color:#111827; cursor:pointer;
}

/* (opcional) ícone/botão Street View se você decidir mover para o HUD */
#tempo .sv-btn{
  display:inline-flex; align-items:center; gap:8px;
  margin-top:6px;
  padding:8px 12px;
  border:1px solid var(--borda);
  border-radius:10px;
  background:#fff;
  font-weight:700;
  cursor:pointer;
  transition: background .15s, border-color .15s;
}
#tempo .sv-btn:hover{ background:#f3f4f6; border-color:#cbd5e1; }

/* =========================================================
   OVERLAY / SPINNER
   ========================================================= */
.overlay-loading{
  position: fixed; inset:0;
  background: rgba(255,255,255,.8);
  display: flex; align-items: center; justify-content: center; flex-direction: column;
  z-index: 3000;
}
.spinner{
  border: 6px solid #ccc; border-top: 6px solid var(--azul);
  border-radius: 50%; width: 48px; height: 48px; animation: girar 1s linear infinite;
}
.texto-loading{ margin-top: 12px; color: var(--azul); font-weight:700; }
@keyframes girar{ 0%{ transform: rotate(0); } 100%{ transform: rotate(360deg); } }

/* =========================================================
   RESPONSIVO
   ========================================================= */
@media (max-width: 920px){
  .painel-busca{ width: 90vw; max-width: 440px; right:12px; }
}
@media (max-width: 560px){
  .painel-busca{ left:12px; right:12px; top:76px; }
  .painel-busca .actions{ grid-template-columns: 1fr 1fr; }
  #widget-clima{ left:12px; right:auto; }
}

/* =========================================================
   INDICADORES (BI) – Modal + Detalhes por Município
   ========================================================= */

/* backdrop do modal */
.bi-backdrop{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  z-index:4000;
  background:rgba(0,0,0,.45);
}

/* cartão principal */
.bi-card{
  width:min(980px,96vw);
  max-height:90vh;
  overflow:auto;
  background:#ffffff;
  border-radius:14px;
  box-shadow:0 18px 45px rgba(15,23,42,.35);
  font-family:'Segoe UI',system-ui,-apple-system,Roboto,Arial,sans-serif;
}

/* cabeçalho */
.bi-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 18px;
  border-bottom:1px solid #e5e7eb;
  background:linear-gradient(90deg,#0f172a,#020617);
  color:#e5e7eb;
}
.bi-head h3{
  margin:0;
  font-weight:700;
  font-size:16px;
  letter-spacing:.2px;
}
.bi-close{
  border:0;
  background:#111827;
  color:#e5e7eb;
  border-radius:999px;
  padding:6px 12px;
  cursor:pointer;
  font-size:12px;
}
.bi-close:hover{
  background:#020617;
}

/* corpo – gráfico + filtros */
.bi-body{
  padding:16px 18px 12px;
  display:grid;
  grid-template-columns:minmax(0,1.7fr) minmax(260px,0.9fr);
  gap:16px;
}
#chartMunicipios{
  width:100%;
  height:320px;
}
.bi-side{
  display:flex;
  flex-direction:column;
  gap:8px;
}
.bi-side label{
  font-size:13px;
  color:#374151;
}
.bi-input{
  padding:8px 10px;
  border:1px solid #d1d5db;
  border-radius:8px;
  width:100%;
  font-size:13px;
}
.bi-input:focus{
  outline:none;
  border-color:#4f46e5;
  box-shadow:0 0 0 2px rgba(79,70,229,.25);
}
.bi-chk{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:4px;
  font-size:13px;
  color:#374151;
}
.bi-chk input{
  accent-color:#22c55e;
}
.bi-resumo{
  margin-top:6px;
  font-size:13px;
  color:#111827;
}
.bi-btn{
  margin-top:8px;
  border:1px solid #d1d5db;
  background:#ffffff;
  border-radius:999px;
  padding:7px 12px;
  cursor:pointer;
  font-size:13px;
  display:inline-flex;
  align-items:center;
  gap:6px;
}
.bi-btn:hover{
  background:#f9fafb;
}

/* tabela de municípios */
.bi-table-wrap{
  padding:0 18px 16px 18px;
}
.bi-table{
  width:100%;
  border-collapse:collapse;
  font-size:13px;
  border-radius:10px;
  overflow:hidden;
}
.bi-table thead{
  background:#f9fafb;
  border-bottom:1px solid #e5e7eb;
}
.bi-table th,
.bi-table td{
  padding:9px 10px;
  border-bottom:1px solid #f3f4f6;
}
.bi-table th{
  font-weight:600;
  color:#4b5563;
}
.bi-table td.num{
  text-align:right;
  font-variant-numeric:tabular-nums;
}
.bi-table tbody tr{
  cursor:pointer;
}
.bi-table tbody tr:hover{
  background:#f1f5f9;
}

/* célula com brasão + nome do município */
.bi-muni-cell{
  display:flex;
  align-items:center;
  gap:8px;
}
.bi-muni-logo{
  width:24px;
  height:24px;
  border-radius:4px;
  object-fit:contain;
  background:#ffffff;
  box-shadow:0 1px 3px rgba(15,23,42,.2);
  flex-shrink:0;
}
.bi-muni-name{
  white-space:nowrap;
  text-overflow:ellipsis;
  overflow:hidden;
  max-width:220px;
}

/* Detalhes por município */
.bi-detalhes{
  margin-top:12px;
  border-top:1px solid var(--borda);
  padding:10px 12px 12px;
  font-size:12px;
  background:var(--bg-suave);
  border-radius:0 0 var(--radius) var(--radius);
}

.bi-detalhes-header{
  display:flex;
  justify-content:space-between;
  gap:12px;
  align-items:flex-start;
  margin-bottom:6px;
}

.bi-detalhes-main{
  display:flex;
  align-items:flex-start;
  gap:8px;
}

#detMunicipioBrasao{
  width:32px;
  height:32px;
  border-radius:6px;
  object-fit:contain;
  background:#ffffff;
  box-shadow:0 1px 2px rgba(15,23,42,.3);
}

.bi-detalhes h4{
  margin:0 0 3px 0;
  font-size:13px;
  font-weight:700;
  color:var(--texto);
}

.bi-detalhes-resumo{
  margin:0;
  color:var(--texto-2);
  font-size:12px;
}

/* botões de aba: empresas / bairros / ruas */
.bi-detalhes-actions{
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.bi-tab-btn{
  border-radius:999px;
  border:1px solid #cbd5f5;
  background:#e5e7ff;
  padding:6px 10px;
  font-size:11px;
  cursor:pointer;
  color:#111827;
  display:inline-flex;
  align-items:center;
  gap:4px;
  white-space:nowrap;
}
.bi-tab-btn.active{
  background:#4f46e5;
  border-color:#4338ca;
  color:#f9fafb;
  box-shadow:0 3px 10px rgba(79,70,229,.4);
}

/* barra de busca interna */
.bi-detalhes-toolbar{
  margin:6px 0 8px;
  display:flex;
  gap:8px;
  align-items:center;
}
#detBusca{
  flex:1;
  min-width:0;
  padding:6px 9px;
  border-radius:999px;
  border:1px solid #d1d5db;
  font-size:12px;
}
#detBusca:focus{
  outline:none;
  border-color:#4f46e5;
  box-shadow:0 0 0 2px rgba(79,70,229,.25);
}

/* conteúdo de abas */
.bi-detalhes-views{
  margin-top:4px;
}
.bi-tab-view{
  display:none;
}
.bi-tab-view.active{
  display:block;
}

/* título interno de cada aba */
.bi-tab-view > strong{
  display:block;
  margin-bottom:4px;
  font-size:11px;
  color:#4b5563;
}

/* mini-tabelas internas (empresas / bairros / ruas) */
.bi-mini-table{
  width:100%;
  border-collapse:collapse;
  font-size:11px;
  background:#ffffff;
  border-radius:8px;
  overflow:hidden;
}
.bi-mini-table th,
.bi-mini-table td{
  padding:4px 6px;
  border-bottom:1px solid #e5e7eb;
}
.bi-mini-table th{
  text-align:left;
  background:#f3f4f6;
  color:#4b5563;
}
.bi-mini-table td.num{
  text-align:right;
  font-variant-numeric:tabular-nums;
}
